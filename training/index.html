<html>
<title>CA Big Tree Cluster Tracker</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="manifest" href="/site.webmanifest">
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css"/>       
<link rel="stylesheet" href="lib/leafletjs/leaflet.css">
<link rel="stylesheet" href="css/custom.css">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
.w3-bar,h1,button {font-family: "Montserrat", sans-serif}
.fa-anchor,.fa-coffee {font-size:200px}
.dropdown {position: relative; display: inline-block; width: 150px}
.dropdown-content {display: none; position: absolute; z-index: 2000; width: 100%; background-color:#f1f1f1; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2)} 
.timel {display: block; width: 100%; text-align: center;}
.show {display:block;}
</style>
    <body>
        <h1>California Big Tree Cluster Tracker </h1>
        <script>
            function showList(op) {
                if (op == "time") {
                    document.getElementById("myDropdown").classList.toggle("show");
                } else if (op == "color") {
                    document.getElementById("myDropColor").classList.toggle("show");
                }
            }
            window.onclick = function(event) {
                if (!event.target.matches('.dropbtn')) {
                    var dropdowns = document.getElementsByClassName("dropdown-content");
                    var i;
                    for (i = 0; i < dropdowns.length; i++) {
                        var openDropdown = dropdowns[i];
                        if (openDropdown.classList.contains('show')) {
                            openDropdown.classList.remove('show');
                        }
                    }
                }
            }
        </script>
        <div class="dropdown" id="droploc">
            <button onclick="showList('time')" class="dropbtn">Choose Map Display Time Period</button>
            <div id="myDropdown" class="dropdown-content">
                <button id="btn_time_0" class="timel btn_selected" onclick="changeMap(0)">Whole Pandemic</p>
                <button id="btn_time_12" class="timel" onclick="changeMap(12)">Last 12 Months</p>
                <button id="btn_time_6" class="timel" onclick="changeMap(6)">Last 6 Months</p>
                <button id="btn_time_3" class="timel" onclick="changeMap(3)">Last 3 Months</p>
            </div>
        </div>
        <div class="dropdown" id="dropcolor">
            <button onclick="showList('color')" class="dropbtn" id="colorbtn" disabled>Select Map Layer</button>
            <div id="myDropColor" class="dropdown-content">
                <button id="btn_color_0" class="timel" onclick="changeScale(0)">Raw Cluster Count</p>
                <button id="btn_color_1" class="timel btn_selected" onclick="changeScale(1)">Log Fold Enrichment</p>
            </div>
        </div>
        <div id="display" title="This map displays the count of inferred unique families of the virus in each region by default. When a region is selected, it instead displays a scaled estimate of the count of viral introductions to the selected region from each other region.">
            <div id="mapid"></div>
            <style>
                #mapid {
                    height: 400px;
                }
            </style>
        </div>
        <div id="maintext">
            <p>The California Big Tree Cluster Tracker combines sequence data from the <a title="Repository containing daily-updated comprehensive global phylogenetic trees for SARS-CoV-2" target="_blank" href="https://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/">global public SARS-CoV-2 phylogenetic tree</a> and sequences in California’s central repository in Terra. The Cluster Tracker applies a <a title="Wiki page describing the heuristic calculation." target="_blank" href="https://usher-wiki.readthedocs.io/en/latest/matUtils.html#introduce">heuristic</a> to identify groups of sequences in a given region that may have recently arrived from another region. These groups may reflect cases of an infected traveler entering a region, followed by local spread. Note that biases might affect these results: relative local sequencing effort, the rate sequences arrive in repositories, and accuracy of reconstructed evolutionary relationships. You can view each <span class="definition" title="The set of sequences within a region that are inferred to result from a single introduction via travel.">cluster</span> in <a title="link to California Big Tree Investigator" href="https://investigator.big-tree.ucsc.edu/" target="_blank">CA Big Tree Investigator</a> or <a title="Github repository for the Taxonium browser tree viewer" href="https://github.com/theosanderson/taxonium" target="_blank">Taxonium</a> and perform your own analysis with UCSC’s <a title="Github repository for UShER" href="https://github.com/yatisht/usher" target="_blank">UShER</a> after downloading the output files from the link below the table.
            </p>
        </div>
        <div id="table-container"></div>
        <script src="lib/leafletjs/leaflet.js"></script>
        <script src="https://storage.googleapis.com/ucsc-gi-cdph-bigtree/display_tables/training/regions.js"></script>
        <script src="scripts/main.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script>!window.jQuery && document.write('<script src="sripts/jquery.min.js"><\/script>')</script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.2.1/js/bootstrap.bundle.min.js"></script>
        <script src="scripts/jquery.csv.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
        <script src="scripts/csv_to_html_table.js"></script> 
        <script>
           loadTargetTable('https://storage.googleapis.com/ucsc-gi-cdph-bigtree/display_tables/training/default_clusters.tsv');
        </script>
        <a href = "https://storage.googleapis.com/ucsc-gi-cdph-bigtree/display_tables/training/hardcoded_clusters.tsv.gz", download = "sarscov2_clusters.tsv.gz">Download full output file.</a><br>
        <a href = "https://storage.googleapis.com/ucsc-gi-cdph-bigtree/display_tables/training/cview.pb.gz", download = "cluster_taxonium.pb.gz">Download the taxonium protobuf for viewing.</a>
        <p>Please post an issue at <a title="The github repository for this site." href="https://github.com/pathogen-genomics/introduction-website" target="_blank">the github</a> or email us at help-pathogengenomics@ucsc.edu if you have questions or feedback.</p>
    </body>
</html>